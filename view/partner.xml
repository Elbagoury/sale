<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
        <record id="view_partner_form_add_affiliate" model="ir.ui.view">
            <field name="name">res.partner.form</field>
            <field name="model">res.partner</field>
            <field eval="3" name="priority"/>
            <field name="inherit_id" ref="base.view_partner_form"/>
            <field name="arch" type="xml">

				<field name="website" position="after">
					<!-- Business ID is only shown for Finnish top-level companies, i.e. those that don't have a parent. -->
					<field name="businessid_required" invisible="1"/>
					
					<field name="businessid" 
						   attrs="{'invisible':[('businessid_required','=',False)], 
									'required':[('businessid_required','=',True)]}"/>
				</field>

				<!-- Attach onchange methods to is_company, parent_id and country_id. They trigger the check
				     whether business id should be set to be mandatory -->
				<field name="country_id" position="attributes">
                        <attribute name="required">True</attribute>
						<attribute name="on_change">business_id_and_vat_change(country_id, is_company, parent_id)</attribute>					
				</field>

				<field name="is_company" position="attributes">
						<attribute name="on_change">business_id_and_vat_change(country_id, is_company, parent_id)</attribute>					
				</field>

				<field name="parent_id" position="attributes">
						<attribute name="on_change">business_id_and_vat_change(country_id, is_company, parent_id)</attribute>					
				</field>

				<field name="vat" position="after">
					<field name="vatnumber_required" invisible="1" />
				</field>
				
				<!--
				<field name="vat" position="attributes">
					
					<attribute name="attrs">{'invisible':[('vatnumber_required','=',False)], 
									'required':[('vatnumber_required','=',True)]}</attribute>	
				</field>

				<field name="vat_subjected" position="attributes">
					<attribute name="attrs">{'invisible':[('vatnumber_required','=',False)], 
									'required':[('vatnumber_required','=',True)]}</attribute>	
				</field>



				<button name="button_check_vat" position="attributes">
					<attribute name="attrs">{'invisible':[('vatnumber_required','=',False)], 
									'required':[('vatnumber_required','=',True)]}</attribute>	
				</button>
				-->
				<label for="vat" position="replace"/>
				<field name="vat" position="replace"/>
				<button name="button_check_vat" position="replace"/>
				<field name="vat_subjected" position="replace"/>
				
				<field name="website" position="after">
					<label for="vat" attrs="{'invisible':[('vatnumber_required','=',False)], 
									'required':[('vatnumber_required','=',True)]}"/>
                    <div name="vat_info" attrs="{'invisible':[('vatnumber_required','=',False)]}">
                        <field name="vat" on_change="vat_change(vat)" placeholder="e.g. BE0477472701" class="oe_inline" attrs="{'invisible':[('vatnumber_required','=',False)], 
									'required':[('vatnumber_required','=',True)]}"/>
                        <button colspan="2" name="button_check_vat" string="Check Validity" type="object" icon="gtk-execute" class="oe_inline" attrs="{'invisible':[('vatnumber_required','=',False)], 
									'required':[('vatnumber_required','=',True)]}"/>
                        <field name="vat_subjected" class="oe_inline" attrs="{'invisible':[('vatnumber_required','=',False)], 
									'required':[('vatnumber_required','=',True)]}"/>
                    </div>
				</field>



				
			</field>
		</record>
    </data>
</openerp>

